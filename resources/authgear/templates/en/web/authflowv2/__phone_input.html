<!-- Example usage:
{{ template "authflowv2/__phone_input.html"
  (dict
    "CountryLabel" "Country"
    "Placeholder" "Phone number"
    "ErrorMessage" "Please select a country"
    "EmptyMessage" "No results found"
    "InputName" "phone"
  )
}}
-->

{{ define "authflowv2/__phone_input.html" }}
<div class="phone-input" data-controller="phone-input">
  <div data-controller="custom-select" data-phone-input-target="countrySelect">
    <input
      type="hidden"
      data-custom-select-target="input"
      data-action="input->phone-input#handleCountryInput"
    />

    <!-- Select Button -->
    <button
      class="phone-input__trigger"
      aria-haspopup="listbox"
      aria-expanded="false"
      data-custom-select-target="trigger"
      data-action="click->custom-select#toggle"
    >{{ $.CountryLabel }}</button>

    <!-- Dropdown Menu -->
    <div
      class="select__dropdown"
      role="listbox"
      data-custom-select-target="dropdown"
    >
      <ul
        class="select__options"
        data-custom-select-target="options"
        tabindex="-1"
      >
      </ul>

      <template data-custom-select-target="searchTemplate">
        <div class="select__search-container">
          <div class="select__search">
            <input
              tabindex="0"
              class="select__search-input"
              placeholder="Search"
              data-custom-select-target="search"
              data-action="input->custom-select#search"
            >
            <div class="select__search-icon">
              <i class="material-icons">search</i>
            </div>
            <button
              class="select__clear-icon"
              type="button"
              tabindex="-1"
              data-custom-select-target="clearSearch"
              data-action="click->custom-select#clearSearch"
            >
              <i class="material-icons material-icons--filled">cancel</i>
            </button>
          </div>
          <button
            class="select__close-icon"
            type="button"
            tabindex="-1"
            data-action="click->custom-select#close"
          >
            <i class="material-icons material-icons">close</i>
          </button>
        </div>
      </template>

      <template data-custom-select-target="itemTemplate">
        <li
          class="select__option"
          role="option"
          data-action="
            click->custom-select#handleSelect
            keydown->custom-select#handleKeyDown
          "
          tabindex="0"
        >
          <span data-label="prefix" class="select__option-prefix"></span>
          <span data-label="content" class="select__option-content"></span>
        </li>
      </template>

      <template data-custom-select-target="emptyTemplate">
        <li class="select__empty">
          {{ $.EmptyMessage }}
        </li>
      </template>
    </div>
  </div>
  <div>
    <input
      class="input w-full {{ if $.ErrorMessage }}input--error{{ end }}"
      placeholder="{{ $.Placeholder }}"
      type="text"
      inputmode="numeric"
      pattern="^[0-9]*$"
      data-action="input->phone-input#handleNumberInput"
    />
    {{ if $.ErrorMessage }}
    <div class="phone-input__error-message">{{ $.ErrorMessage }}</div>
    {{ end }}
  </div>
  <input
    type="hidden"
    name="{{ $.InputName }}"
    data-phone-input-target="input"
  />
</div>
{{ end }}
